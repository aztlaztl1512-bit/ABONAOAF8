<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>اختبار القدرات اللفظي - النموذج 23 (المطور)</title>
    <style>
        :root { --primary-color: #16a085; --secondary-color: #e67e22; --bg-color: #e8f8f5; --white: #ffffff; --correct-bg: #d4edda; --wrong-bg: #f8d7da; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: var(--bg-color); display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; padding: 20px; }
        .quiz-card { background: var(--white); width: 95%; max-width: 850px; padding: 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); border-top: 8px solid var(--primary-color); text-align: center; }
        .challenger-badge { background: var(--secondary-color); color: white; padding: 8px 20px; border-radius: 30px; font-weight: bold; display: inline-block; margin-bottom: 20px; font-size: 1.2rem; }
        input[type="text"] { width: 80%; padding: 12px; border: 2px solid #ddd; border-radius: 10px; font-size: 1.1rem; margin: 20px 0; text-align: center; }
        .btn { background: var(--primary-color); color: white; padding: 12px 30px; border: none; border-radius: 10px; font-size: 1.1rem; cursor: pointer; transition: 0.3s; margin: 5px; }
        .timer-bar { height: 10px; background: #eee; border-radius: 5px; margin: 20px 0; overflow: hidden; }
        .timer-progress { height: 100%; background: #e74c3c; width: 100%; transition: width 1s linear; }
        .options-container { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 25px; }
        .option { padding: 15px; border: 2px solid #f1f2f6; border-radius: 12px; cursor: pointer; font-weight: 500; transition: 0.2s; }
        .correct-opt { background: #dff9fb !important; border-color: #2ecc71 !important; color: #27ae60; }
        .wrong-opt { background: #ffeaa7 !important; border-color: #e74c3c !important; color: #c0392b; }
        .feedback { margin-top: 20px; padding: 20px; border-radius: 12px; display: none; background: #f8f9fa; text-align: right; border-right: 5px solid var(--primary-color); }
        .summary-item { padding: 15px; border-bottom: 1px solid #eee; margin-bottom: 10px; border-radius: 8px; text-align: right; }
        .summary-correct { background-color: var(--correct-bg); border-right: 5px solid #28a745; }
        .summary-wrong { background-color: var(--wrong-bg); border-right: 5px solid #dc3545; }
        .hidden { display: none; }
    </style>
</head>
<body>

<div class="quiz-card">
    <div class="header-info">
        <div style="font-weight: bold; color: var(--primary-color);">ثانوية الأمير عبدالمجيد</div>
        <div style="color: #7f8c8d;">أ / عبدالعزيز الفيفي</div>
        <h1>اختبار التناظر - النموذج 23 المطور</h1>
    </div>

    <div id="start-page">
        <p>تحدي علاقات (الجمع والمفرد) و (التتابع)</p>
        <input type="text" id="studentName" placeholder="اكتب اسمك هنا...">
        <br>
        <button class="btn" onclick="startQuiz()">ابدأ الاختبار</button>
    </div>

    <div id="quiz-page" class="hidden">
        <div class="challenger-badge">المتحدي: <span id="display-name"></span></div>
        <div style="display: flex; justify-content: space-between;">
            <span>السؤال: <b id="q-num">1</b> / 20</span>
            <span style="color: #e74c3c;">الوقت: <b id="timer-text">45</b> ث</span>
        </div>
        <div class="timer-bar"><div id="timer-line" class="timer-progress"></div></div>
        <h2 id="question-text"></h2>
        <div class="options-container" id="options"></div>
        <div id="feedback" class="feedback"></div>
        <button id="next-btn" class="btn hidden" onclick="loadNextQuestion()">السؤال التالي</button>
    </div>

    <div id="result-page" class="hidden">
        <h2 id="score-text"></h2>
        <div id="quiz-summary" style="max-height: 400px; overflow-y: auto;"></div>
        <button class="btn" onclick="location.reload()">إعادة</button>
    </div>
</div>

<script>
    const masterQuestions = [
        // من الصورة (35) - علاقة جمع ومفرد
        { q: "تقي : أتقياء", correct: "وفي : أوفياء", a: ["وفي : أوفياء", "كريم : بخلاء", "شجاع : خوف", "طالب : مدرسة"], why: "علاقة (مفرد وجمعه): التقي جمعه أتقياء والوفي جمعه أوفياء." },
        { q: "شقي : أشقياء", correct: "نبي : أنبياء", a: ["نبي : أنبياء", "رجل : امرأة", "بيت : غرف", "علم : علماء"], why: "علاقة (مفرد وجمعه): شقي أشقياء ونبي أنبياء." },
        { q: "أغبياء : غبي", correct: "علماء : عالم", a: ["علماء : عالم", "طلاب : فصل", "أذكياء : عبقري", "كتب : مكتبة"], why: "علاقة (جمع ومفرده): الأغبياء مفردها غبي والعلماء مفردها عالم." },
        
        // من الصورة (36) - علاقة تتابع
        { q: "صافرة : ابتداء", correct: "حمل : ولادة", a: ["حمل : ولادة", "موت : قبر", "فشل : إهمال", "نوم : حلم"], why: "علاقة (تتابع): الصافرة تتبعها البداية والحمل تتبعه الولادة." },
        { q: "هبوط : توقف", correct: "تشغيل : انطلاق", a: ["تشغيل : انطلاق", "إقلاع : طيران", "ركض : تعب", "أكل : شبع"], why: "علاقة (تتابع): الهبوط يليه توقف والتشغيل يليه انطلاق." },
        
        // أسئلة خارجية (جديدة تماماً بنفس العلاقات)
        { q: "عزيز : أعزاء", correct: "قوي : أقوياء", a: ["قوي : أقوياء", "غني : مال", "كبير : صغير", "طويل : أطوال"], why: "علاقة (مفرد وجمعه): عزيز جمعها أعزاء وقوي جمعها أقوياء." },
        { q: "وضوء : صلاة", correct: "إحرام : حج", a: ["إحرام : حج", "صيام : رمضان", "زكاة : مال", "تشهد : صلاة"], why: "علاقة (تتابع): الوضوء يتبعه صلاة والإحرام يتبعه حج." },
        { q: "شجر : أشجار", correct: "جبل : جبال", a: ["جبل : جبال", "نهر : ماء", "بحر : سمك", "غابة : أغصان"], why: "علاقة (مفرد وجمعه): شجر جمعها أشجار وجبل جمعها جبال." },
        { q: "فجر : ظهر", correct: "سبت : أحد", a: ["سبت : أحد", "ليل : نهار", "شمس : قمر", "صيف : خريف"], why: "علاقة (تتابع): الظهر يأتي بعد الفجر والأحد يأتي بعد السبت." },
        { q: "كريم : كرماء", correct: "بخيل : بخلاء", a: ["بخيل : بخلاء", "شجاع : جبان", "جميل : وسيم", "طويل : طوال"], why: "علاقة (مفرد وجمعه): كريم جمعها كرماء وبخيل جمعها بخلاء." },
        { q: "زراعة : حصاد", correct: "مذاكرة : نجاح", a: ["مذاكرة : نجاح", "كتابة : قلم", "قراءة : كتاب", "تعلم : معلم"], why: "علاقة (تتابع): الزراعة يتبعها حصاد والمذاكرة يتبعها نجاح." },
        { q: "دقيقة : ساعة", correct: "يوم : أسبوع", a: ["يوم : أسبوع", "ثانية : لحظة", "شهر : سنة", "فجر : نهار"], why: "علاقة (تتابع وتدرج): الدقيقة جزء من الساعة وتؤدي إليها، واليوم يليه أسبوع." },
        { q: "برعم : زهرة", correct: "يرقة : فراشة", a: ["يرقة : فراشة", "نواة : تمرة", "جذر : غصن", "ماء : مطر"], why: "علاقة (تتابع ومرحلية): البرعم يصبح زهرة واليرقة تصبح فراشة." },
        { q: "أوفياء : وفي", correct: "أصدقاء : صديق", a: ["أصدقاء : صديق", "جيش : جندي", "مدرسة : طالب", "كتب : ورق"], why: "علاقة (جمع ومفرده): الأوفياء مفردها وفي والأصدقاء مفردها صديق." },
        { q: "عقد : تنفيذ", correct: "مخطط : بناء", a: ["مخطط : بناء", "مهندس : بيت", "عامل : مصنع", "سفر : طائرة"], why: "علاقة (تتابع): العقد يتبعه تنفيذ والمخطط يتبعه بناء." },
        { q: "شاهد : شهود", correct: "قائد : قادة", a: ["قائد : قادة", "جندي : جيش", "معلم : فصل", "عالم : مختبر"], why: "علاقة (مفرد وجمعه): شاهد جمعها شهود وقائد جمعها قادة." },
        { q: "برق : رعد", correct: "سؤال : جواب", a: ["سؤال : جواب", "نهار : ليل", "شمس : حرارة", "غيم : مطر"], why: "علاقة (تتابع): البرق يتبعه رعد والسؤال يتبعه جواب." },
        { q: "عظيم : عظماء", correct: "رحيم : رحماء", a: ["رحيم : رحماء", "كبير : كبار", "صغير : صغار", "نقي : نقاء"], why: "علاقة (مفرد وجمع على وزن فعلاء): عظيم عظماء ورحيم رحماء." },
        { q: "مدخل : مخرج", correct: "بداية : نهاية", a: ["بداية : نهاية", "صعود : نزول", "فتح : إغلاق", "ذهاب : عودة"], why: "علاقة (تتابع وتضاد): المدخل يتبعه مخرج والبداية تتبعها نهاية." },
        { q: "غيم : مطر", correct: "اجتهاد : تفوق", a: ["اجتهاد : تفوق", "سحاب : ريح", "برد : ثلج", "نار : دخان"], why: "علاقة (تتابع وسببية): الغيم يتبعه مطر والاجتهاد يتبعه تفوق." }
    ];

    let questions = []; let currentQ = 0; let score = 0; let timer; let timeLeft = 45; let userAnswers = [];

    function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    function startQuiz() {
        const name = document.getElementById('studentName').value.trim();
        if(!name) { alert("اكتب اسمك أولاً"); return; }
        document.getElementById('display-name').innerText = name;
        questions = shuffle([...masterQuestions]).slice(0, 20); // نختار 20 سؤالاً من الـ 20 الجديدة
        document.getElementById('start-page').classList.add('hidden');
        document.getElementById('quiz-page').classList.remove('hidden');
        loadQuestion();
    }

    function loadQuestion() {
        if(currentQ >= questions.length) { finishQuiz(); return; }
        const qData = questions[currentQ];
        const shuffledOptions = shuffle([...qData.a]);
        document.getElementById('q-num').innerText = currentQ + 1;
        document.getElementById('question-text').innerText = qData.q;
        document.getElementById('feedback').style.display = 'none';
        document.getElementById('next-btn').classList.add('hidden');
        const optDiv = document.getElementById('options');
        optDiv.innerHTML = '';
        shuffledOptions.forEach(opt => {
            const d = document.createElement('div');
            d.className = 'option'; d.innerText = opt;
            d.onclick = () => checkAnswer(opt, d);
            optDiv.appendChild(d);
        });
        startTimer();
    }

    function startTimer() {
        clearInterval(timer); timeLeft = 45;
        const line = document.getElementById('timer-line');
        const txt = document.getElementById('timer-text');
        timer = setInterval(() => {
            timeLeft--; txt.innerText = timeLeft;
            line.style.width = (timeLeft/45)*100 + '%';
            if(timeLeft <= 0) { clearInterval(timer); checkAnswer(null, null); }
        }, 1000);
    }

    function checkAnswer(sel, el) {
        clearInterval(timer);
        const qData = questions[currentQ];
        const isCorrect = (sel === qData.correct);
        userAnswers.push({ q: qData.q, sel: sel || "انتهى الوقت", cor: qData.correct, isCorrect, why: qData.why });
        document.querySelectorAll('.option').forEach(o => o.onclick = null);
        if(isCorrect) { score++; if(el) el.classList.add('correct-opt'); } 
        else { if(el) el.classList.add('wrong-opt'); document.querySelectorAll('.option').forEach(o => { if(o.innerText === qData.correct) o.classList.add('correct-opt'); }); }
        const f = document.getElementById('feedback');
        f.innerHTML = `<strong>${isCorrect ? '✅ ممتاز' : '❌ انتبه'}</strong><br>${qData.why}`;
        f.style.display = 'block';
        document.getElementById('next-btn').classList.remove('hidden');
    }

    function loadNextQuestion() { currentQ++; loadQuestion(); }

    function finishQuiz() {
        document.getElementById('quiz-page').classList.add('hidden');
        document.getElementById('result-page').classList.remove('hidden');
        document.getElementById('score-text').innerHTML = `النتيجة: ${score} من 20`;
        const sum = document.getElementById('quiz-summary');
        userAnswers.forEach((ans, i) => {
            const d = document.createElement('div');
            d.className = `summary-item ${ans.isCorrect ? 'summary-correct' : 'summary-wrong'}`;
            d.innerHTML = `<b>س${i+1}: ${ans.q}</b><br>إجابتك: ${ans.sel} | الصح: ${ans.cor}<br><small>${ans.why}</small>`;
            sum.appendChild(d);
        });
    }
</script>
</body>
</html>